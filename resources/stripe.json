{
  "database": {
    "user": "samprotas",
    "dbtype": "postgresql",
    "dbname": "data_generator",
    "host": "localhost",
    "port": 5432
  },
  "models": {
    "plan": {
      "model": {
        "id": {
          "primarykey": true,
          "type": "string",
          "value": {
            "type": "uuid"
          }
        },
        "amount": {
          "type": "integer",
          "master": {
            "count": 3
          },
          "value": {
            "type": "formula",
            "properties": {
              "equation": "2.5 * x ^ 2 + 42.5 * x + 5"
            }
          }
        },
        "popularity": {
          "type": "integer",
          "virtual": true,
          "value": {
            "type": "formula",
            "properties": {
              "equation": "10 - 3 * x"
            }
          }
        },
        "interval": {
          "type": "string",
          "value": {
            "type": "case",
            "check": "$$self.amount < 100",
            "branches": {
              "true": {
                "type": "enum",
                "weights": {
                  "monthly": 1
                }
              },
              "false": {
                "type": "enum",
                "weights": {
                  "yearly": 1
                }
              }
            }
          }
        }
      }
    },
    "customer": {
      "model": {
        "id_virtual": {
          "type": "string",
          "virtual": true,
          "value": {
            "type": "uuid"
          }
        },
        "id": {
          "primarykey": true,
          "type": "string",
          "value": {
            "type": "concat",
            "properties": {
              "values": ["cus_", "$$self.id_virtual"]
            }
          }
        },
        "decay_virtual": {
          "type": "double",
          "virtual": true,
          "master": {
            "count": 1000
          },
          "value": {
            "type": "formula",
            "properties": {
              "equation": "x / 50"
            }
          }
        },
        "created": {
          "type": "integer",
          "value": {
            "type": "formula",
            "properties": {
              "equation": "1395065886 + 51840 * x * 0.98 ^ $$self.decay_virtual"
            }
          }
        }
      }
    },
    "invoices": {
      "model": {
        "id_virtual": {
          "type": "string",
          "virtual": true,
          "value": {
            "type": "uuid"
          }
        },
        "id": {
          "primarykey": true,
          "type": "string",
          "value": {
            "type": "concat",
            "properties": {
              "values": ["in_", "$$self.id_virtual"]
            }
          }
        },
        "total": {
          "type": "integer",
          "value": {
            "type": "enum",
            "weights": {
              "$subscriptions.plan_total": 1
            }
          }
        },
        "date": {
          "type": "integer",
          "value": {
            "type": "range",
            "properties": {
              "min": 1408045611,
              "max": 1458045611
            }
          }
        },
        "period_start": {
          "type": "integer",
          "value": {
            "type": "formula",
            "properties": {
              "equation": "$$self.date"
            }
          }
        },
        "period_end": {
          "type": "integer",
          "value": {
            "type": "formula",
            "properties": {
              "equation": "$$self.date"
            }
          }
        },
        "subscription": {
          "type": "association",
          "master": {
            "model": "subscriptions",
            "quantity": {
              "type": "range",
              "properties": {
                "min": 0,
                "max": 10
              }
            }
          }
        },
        "customer": {
          "type": "string",
          "value": {
            "type": "enum",
            "weights": {
              "$subscriptions.customer": 1
            }
          }
        },
        "paid": {
          "type": "boolean",
          "value": {
            "type": "enum",
            "weights": {
              "true": 9,
              "false": 1
            }
          }
        },
        "forgiven": {
          "type": "boolean",
          "value": {
            "type": "case",
            "check": "$$self.paid",
            "branches": {
              "true": {
                "type": "enum",
                "weights": {
                  "false": 1
                }
              },
              "false": {
                "type": "enum",
                "weights": {
                  "false": 2,
                  "true": 8
                }
              }
            }
          }
        }
      }
    },
    "subscriptions": {
      "model": {
        "id_virtual": {
          "type": "string",
          "virtual": true,
          "value": {
            "type": "uuid"
          }
        },
        "id": {
          "primarykey": true,
          "type": "string",
          "value": {
            "type": "concat",
            "properties": {
              "values": ["sub_", "$$self.id_virtual"]
            }
          }
        },
        "plan_total": {
          "type": "integer",
          "virtual": true,
          "value": {
            "type": "enum",
            "weights": {
              "$plan.amount": 1
            }
          }
        },
        "customer": {
          "type": "association",
          "master": {
            "model": "customer",
            "quantity": {
              "type": "enum",
              "weights": {
                "1": 90,
                "2": 8,
                "3": 2
              }
            }
          }
        },
        "plan__id": {
          "type": "association",
          "value": {
            "model": "plan",
            "weight": "popularity"
          }
        },
        "closed_odds": {
          "type": "real",
          "virtual": true,
          "value": {
            "type": "range",
            "properties": {
              "min": 0,
              "max": 1
            }
          }
        },
        "interval_int": {
          "type": "integer",
          "virtual": true,
          "value": {
            "type": "case",
            "check": "$plan.interval",
            "branches": {
              "monthly": {
                "type": "enum",
                "weights": {
                  "2635200": 1
                }
              },
              "yearly": {
                "type": "enum",
                "weights": {
                  "31536000": 1
                }
              }
            }
          }
        },
        "interval_count": {
          "type": "integer",
          "virtual": true,
          "value": {
            "type": "range",
            "properties": {
              "min": 1,
              "max": 3
            }
          }
        },
        "ended_at": {
          "type": "integer",
          "value": {
            "type": "case",
            "check": "z - y <= 1",
            "branches": {
              "true": {
                "type": "enum",
                "weights": {
                  "$$null": 1
                }
              },
              "false": {
                "type": "formula",
                "properties": {
                  "equation": "$$self.start + $$self.interval_count * $$self.interval_int"
                }
              }
            }
          }
        },
        "start": {
          "type": "integer",
          "value": {
            "type": "case",
            "check": "y == 0",
            "branches": {
              "true": {
                "type": "enum",
                "weights": {
                  "$customer.created": 1
                }
              },
              "false": {
                "type": "formula",
                "properties": {
                  "equation": "$$mult$subscriptions$(y - 1).ended_at"
                }
              }
            }
          }
        }
      }
    }
  }
}


